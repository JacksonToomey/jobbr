language: python
python:
  - "3.6"
sudo: required
env:
  - NODE_JS_VERSION=4
script:
  - curl -o ~/.nvm/nvm.sh https://raw.githubusercontent.com/creationix/nvm/v0.31.0/nvm.sh # update nvm
  - bash -c "nvm use $NODE_JS_VERSION" || true
  - bash -c "source ~/.nvm/nvm.sh; nvm install $NODE_JS_VERSION; node --version"
node_js:
  - "4.3"
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      # nodejs >v4 compiler requirements
      - g++-4.8
      - openjdk-7-jdk
before_install:
  - sudo apt-key adv --fetch-keys http://dl.yarnpkg.com/debian/pubkey.gpg
  - echo "deb http://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
  - sudo apt-get update -qq
  - sudo apt-get install -y -qq yarn
cache:
  yarn: true
services:
  - postgresql
before_script:
  - psql -c 'create database jobbr;' -U postgres
  - psql -c 'create database test_jobbr;' -U postgres
  - python manage.py db upgrade
  - yarn
  - webpack -p
install: "pip install -r requirements.txt"
script: python -m unittest